---
// BlogPostLayout.astro — wraps individual blog post markdown pages
import BaseLayout from './BaseLayout.astro';

interface Props {
  title: string;
  date: Date;
  category: string;
  excerpt: string;
  readTime?: string;
}

const { title, date, category, excerpt, readTime } = Astro.props;

const formattedDate = new Date(date).toLocaleDateString('en-US', {
  year: 'numeric',
  month: 'long',
  day: 'numeric',
});
---

<BaseLayout
  title={`${title} | Anurag Jain`}
  description={excerpt}
  ogTitle={title}
  ogUrl={Astro.url.href}
  bodyDataPage="blog-post"
>
  <Fragment slot="head">
    <style>
      body[data-page="blog-post"] {
        background: #05070f;
      }
      body[data-page="blog-post"]::before {
        content: "";
        position: fixed;
        inset: 0;
        pointer-events: none;
        background-image:
          linear-gradient(to right, rgba(148, 163, 184, 0.035) 1px, transparent 1px),
          linear-gradient(to bottom, rgba(148, 163, 184, 0.025) 1px, transparent 1px);
        background-size: 72px 72px;
        mask-image: radial-gradient(ellipse 80% 60% at 50% 0%, rgba(0,0,0,0.28), transparent 75%);
      }

      .post-back {
        position: fixed;
        top: 14px; left: 14px;
        z-index: 1000;
        padding: 0.44rem 0.84rem;
        border-radius: 999px;
        text-decoration: none;
        background: rgba(8, 12, 24, 0.7);
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        border: 1px solid rgba(96, 165, 250, 0.28);
        color: var(--text-primary);
        font-size: 0.86rem;
        transition: border-color 0.18s ease;
      }
      .post-back:hover { border-color: rgba(56, 189, 248, 0.52); }

      .post-shell {
        max-width: 760px;
        margin: 0 auto;
        padding: clamp(5.5rem, 8vw, 7rem) clamp(1.5rem, 5vw, 3rem) clamp(3rem, 6vw, 5rem);
      }

      .post-header { margin-bottom: 2.5rem; }
      .post-cat {
        font-size: 0.62rem;
        font-weight: 700;
        letter-spacing: 0.12em;
        text-transform: uppercase;
        color: var(--accent-secondary);
        margin-bottom: 0.6rem;
        display: block;
      }
      .post-title {
        font-size: clamp(1.7rem, 3.5vw, 2.6rem);
        font-weight: 700;
        line-height: 1.15;
        margin: 0 0 0.75rem;
      }
      .post-meta {
        font-size: 0.82rem;
        color: var(--muted);
        display: flex;
        gap: 0.4rem;
        flex-wrap: wrap;
        align-items: center;
      }
      .post-meta .sep { opacity: 0.4; }

      /* Prose styles */
      .post-body {
        color: var(--text-secondary);
        line-height: 1.75;
        font-size: clamp(0.97rem, 1.1vw, 1.07rem);
      }
      .post-body h2, .post-body h3, .post-body h4 {
        color: var(--text-primary);
        margin: 2rem 0 0.75rem;
      }
      .post-body h2 { font-size: clamp(1.3rem, 2vw, 1.7rem); }
      .post-body h3 { font-size: clamp(1.1rem, 1.6vw, 1.3rem); }
      .post-body p { margin-bottom: 1.2rem; }
      .post-body a { color: var(--accent); text-decoration: underline; text-underline-offset: 3px; }
      .post-body a:hover { color: var(--accent-secondary); }
      .post-body ul, .post-body ol { padding-left: 1.4rem; margin-bottom: 1.2rem; }
      .post-body li { margin-bottom: 0.4rem; }
      .post-body code {
        font-family: 'Fira Code', 'Cascadia Code', monospace;
        font-size: 0.87em;
        background: rgba(255,255,255,0.07);
        padding: 0.15em 0.4em;
        border-radius: 4px;
        color: var(--accent);
      }
      .post-body pre {
        background: rgba(10, 16, 28, 0.9);
        border: 1px solid rgba(255,255,255,0.08);
        border-radius: 10px;
        padding: 1.2rem 1.4rem;
        overflow-x: auto;
        margin-bottom: 1.4rem;
      }
      .post-body pre code { background: none; padding: 0; color: var(--text-secondary); }
      .post-body blockquote {
        border-left: 3px solid var(--accent);
        padding-left: 1.1rem;
        margin: 1.4rem 0;
        color: var(--muted);
        font-style: italic;
      }
      .post-body hr {
        border: none;
        border-top: 1px solid rgba(255,255,255,0.08);
        margin: 2rem 0;
      }
      .post-body img { max-width: 100%; border-radius: 10px; margin: 1rem 0; }
    </style>
  </Fragment>

  <a class="post-back" href="/blog">← All Posts</a>

  <main class="post-shell">
    <header class="post-header">
      <span class="post-cat">{category}</span>
      <h1 class="post-title">{title}</h1>
      <div class="post-meta">
        <time datetime={date.toISOString()}>{formattedDate}</time>
        {readTime && <><span class="sep">·</span><span>{readTime}</span></>}
      </div>
    </header>

    <article class="post-body">
      <slot />
    </article>
  </main>
</BaseLayout>
